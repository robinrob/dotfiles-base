IFS="
"

function line_contains_modifications {
  line=$1
  if $(is_file_or_dir $(print $line | gawk '{print $2}')) || $(is_file_or_dir $(print $line | gawk '{print $1}')) || $(string_contains $line 'deleted:')
  then
    return 0
  else
    return 1
  fi
}

local item_num=1
# Read all lines from command output INCLUDING newlines
for line in "${(@f)"$(git status)"}"
do
  if line_contains_modifications $line
  then
    print "$(red $line) $(blue \($item_num\))"

    item_num=$(( item_num + 1 ))
  elif string_contains $line 'new file:'
  then
    green $line
  else
    print $line
  fi
done

