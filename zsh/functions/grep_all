local +r GrepExpression
local +r FindExpression
local +r Where='.'
local +r MaxDepth


while getopts :g:f:w:d: name
do
	case $name in
		g) GrepExpression="$OPTARG" ;;
    f) FindExpression="$OPTARG" ;;
    w) Where="$OPTARG" ;;
    d) MaxDepth="-maxdepth $OPTARG" ;;
    *) red 'grep_all -g <grep-expression> -f <find-expression> -w <where> -d <depth>'
	esac
done

IFS=" 
"
for file in $(gfind $Where ${=MaxDepth} -follow -name $FindExpression -type f)
do
  grep=$(grep -i $GrepExpression $file)
  if [[ -n $grep ]]
  then
    yellow $file
    print $grep | grep -i $GrepExpression
  fi
done
